完整的系统，包含：

✅ 已完成的：登录、注册、个人中心、密码修改、邮箱验证、管理员功能

🔄 要新增的：可灵活配置的一级/二级导航菜单功能

🏠 主界面功能

让我为您重新整理一个完整的需求文档，包含现有功能和新增功能：

📋 MyWeb 完整系统需求文档
📄 文档信息
项目名称: MyWeb 全功能Web平台

文档版本: V2.0

创建日期: 2026-02-03

状态: 实施阶段

🏗️ 系统架构总览
text
MyWeb 全功能平台
├── ✅ 核心认证系统
│   ├── 用户注册/登录/退出
│   ├── 邮箱验证系统
│   ├── 会话管理
│   └── 安全防护
├── ✅ 用户管理中心
│   ├── 个人资料管理
│   ├── 密码修改
│   └── 头像设置
├── ✅ 管理员系统
│   ├── 用户管理
│   ├── 权限管理
│   └── 未验证用户清理
├── 🔄 动态功能系统（新增）
│   ├── 可配置导航菜单
│   ├── 功能页面管理
│   └── 权限控制
├── 🏠 主界面系统
│   ├── 仪表盘
│   ├── 功能导航
│   └── 信息展示
└── 📊 数据统计（可选）
    ├── 用户行为分析
    └── 系统使用统计
📋 第一部分：已实现功能（保持稳定）
1.1 用户认证系统 ✅
功能描述：完整的用户注册、登录、验证流程
已包含：

用户注册（带邮箱验证）

双通道登录（普通用户/管理员）

邮箱验证流程

会话管理和安全退出

"记住我"功能

密码加密存储

1.2 用户个人中心 ✅
功能描述：用户个人信息管理
已包含：

个人资料查看/编辑

头像设置和显示

密码修改（需验证原密码）

邮箱验证状态显示

响应式界面设计

1.3 管理员后台 ✅
功能描述：系统管理功能
已包含：

专用管理员登录入口

用户列表管理

用户状态控制（启用/禁用）

未验证用户清理（手动）

应用启动自动清理7天前未验证用户

管理员权限验证

🚀 第二部分：新增核心功能（动态导航系统）
2.1 动态导航菜单系统 🔄
目标：让管理员无需编程即可添加新功能

2.1.1 功能配置数据库设计
python
# MongoDB 集合设计
# collections: dynamic_functions
{
    "_id": "唯一ID",
    "name": "功能唯一标识",
    "title": "显示标题",
    "description": "功能描述",
    "url_path": "访问路径",
    "icon": "菜单图标",
    
    # 菜单配置
    "menu_level": 1,  # 1=一级菜单，2=二级菜单
    "parent_id": null,  # 父级菜单ID（二级菜单时使用）
    "menu_order": 10,  # 排序序号
    "show_in_menu": true,  # 是否显示在菜单
    "is_external": false,  # 是否外部链接
    
    # 页面配置
    "template_type": "page",  # page/form/list/custom
    "content": "页面内容HTML",
    "extra_css": "附加CSS",
    "extra_js": "附加JavaScript",
    
    # 权限控制
    "access_level": "all",  # all/public/auth/admin/custom
    "required_roles": [],  # 需要的角色
    "required_perms": [],  # 需要的权限
    
    # 状态管理
    "is_active": true,
    "created_at": "创建时间",
    "updated_at": "更新时间",
    "created_by": "创建者"
}
2.1.2 菜单层级结构
text
一级菜单示例：
├── 🏠 首页 (/)
├── 👤 个人中心 (/profile)
├── 📋 功能1 (/function1)
├── 📊 功能2 (/function2)
└── ⚙️ 设置 (/settings)

二级菜单示例：
├── 📁 文档中心
│   ├── 📄 用户手册
│   ├── 📋 操作指南
│   └── 📊 技术文档
├── 🛠️ 工具集
│   ├── 🔧 工具1
│   └── 🧰 工具2
└── 📈 报表
    ├── 📊 日报表
    └── 📈 月报表
2.2 功能页面管理系统 🔄
2.2.1 支持的功能类型
类型	描述	适用场景
基础页面	静态内容展示	帮助文档、公告、介绍页面
表单页面	数据收集表单	问卷调查、申请表单、反馈收集
列表页面	数据列表展示	新闻列表、产品目录、用户目录
自定义页面	HTML/CSS/JS自定义	特殊需求页面
外部链接	跳转到外部URL	第三方系统集成
2.2.2 内容编辑器功能
富文本编辑器（支持图片上传、表格、链接等）

Markdown编辑器

代码编辑器（HTML/CSS/JS）

实时预览功能

模板选择器

2.3 权限控制系统 🔄
2.3.1 访问级别定义
python
ACCESS_LEVELS = {
    "public": "公开访问（无需登录）",
    "all_users": "所有登录用户",
    "verified": "已验证邮箱用户", 
    "admin": "仅管理员",
    "custom": "自定义角色/权限"
}
2.3.2 权限检查流程
python
# 伪代码示例
def check_function_access(function_config, current_user):
    # 1. 检查功能是否激活
    if not function_config.is_active:
        return False
    
    # 2. 检查访问级别
    access_level = function_config.access_level
    
    if access_level == "public":
        return True
    elif not current_user.is_authenticated:
        return False
    elif access_level == "all_users":
        return True
    elif access_level == "verified" and current_user.email_verified:
        return True
    elif access_level == "admin" and current_user.is_admin:
        return True
    elif access_level == "custom":
        # 检查自定义角色/权限
        return check_custom_permission(function_config, current_user)
    
    return False
🏠 第三部分：主界面与用户体验
3.1 主仪表盘设计
3.1.1 用户仪表盘
text
用户登录后看到的主界面：
┌─────────────────────────────────────┐
│ 欢迎栏 [用户名] [通知] [快捷操作]      │
├──────────────┬──────────────────────┤
│ 左侧功能区     │ 主要内容区           │
│ ├─ 个人信息卡  │                     │
│ ├─ 快捷菜单    │ 1. 最近活动         │
│ ├─ 常用功能    │ 2. 系统公告         │
│ └─ 系统状态    │ 3. 待办事项         │
│              │ 4. 快速入门指南      │
└──────────────┴──────────────────────┘
3.1.2 管理员仪表盘
text
管理员专用界面：
┌─────────────────────────────────────┐
│ 系统管理控制台                        │
├──────────────┬──────────────────────┤
│ 管理导航      │ 系统概览             │
│ ├─ 用户管理    │ 1. 用户统计         │
│ ├─ 功能管理    │ 2. 系统状态         │
│ ├─ 系统设置    │ 3. 待处理事项       │
│ ├─ 数据统计    │ 4. 操作日志         │
│ └─ 工具集      │ 5. 性能监控         │
└──────────────┴──────────────────────┘
3.2 导航系统设计
3.2.1 顶部导航栏
html
<!-- 动态生成的导航菜单 -->
<nav class="navbar">
  <div class="navbar-brand">MyWeb</div>
  
  <div class="navbar-menu">
    <!-- 静态菜单项 -->
    <a href="/" class="nav-item">🏠 首页</a>
    <a href="/dashboard" class="nav-item">📊 仪表盘</a>
    
    <!-- 动态生成的一级菜单 -->
    {% for item in primary_menu %}
    <a href="{{ item.url }}" class="nav-item">
      {% if item.icon %}<i class="{{ item.icon }}"></i>{% endif %}
      {{ item.title }}
    </a>
    {% endfor %}
    
    <!-- 二级菜单下拉 -->
    {% for group in menu_groups %}
    <div class="nav-dropdown">
      <span class="nav-dropdown-trigger">
        {% if group.icon %}<i class="{{ group.icon }}"></i>{% endif %}
        {{ group.title }} ▼
      </span>
      <div class="nav-dropdown-content">
        {% for item in group.items %}
        <a href="{{ item.url }}" class="dropdown-item">
          {% if item.icon %}<i class="{{ item.icon }}"></i>{% endif %}
          {{ item.title }}
        </a>
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
  
  <!-- 用户菜单 -->
  <div class="navbar-user">
    <span>{{ current_user.username }}</span>
    <div class="user-dropdown">
      <a href="/profile">👤 个人中心</a>
      <a href="/auth/logout">🚪 退出登录</a>
    </div>
  </div>
</nav>
3.2.2 侧边栏导航（可选）
用于复杂系统，提供更多导航空间

可折叠设计，节省空间

图标+文字组合，直观易用

🔧 第四部分：技术实现方案
4.1 数据库升级方案
4.1.1 新增集合
python
# 1. dynamic_functions - 动态功能配置
# 2. function_categories - 功能分类（可选）
# 3. function_access_logs - 访问日志（可选）
# 4. system_settings - 系统设置（用于存储导航配置等）
4.1.2 数据迁移策略
保持现有users集合不变

新增dynamic_functions集合

逐步迁移现有固定功能到动态配置

4.2 后端架构设计
4.2.1 新增路由结构
python
# routes/dynamic.py - 动态功能路由
dynamic_bp = Blueprint('dynamic', __name__)

@dynamic_bp.route('/<path:function_path>')
def dynamic_function(function_path):
    """动态功能路由 - 匹配所有动态功能URL"""
    # 1. 根据路径查找功能配置
    # 2. 检查权限
    # 3. 渲染对应模板
    pass

# routes/admin_dynamic.py - 动态功能管理
admin_dynamic_bp = Blueprint('admin_dynamic', __name__, url_prefix='/admin/dynamic')

@admin_dynamic_bp.route('/functions')
def function_list():
    """功能列表管理"""
    pass

@admin_dynamic_bp.route('/function/add', methods=['GET', 'POST'])
def add_function():
    """添加新功能"""
    pass

@admin_dynamic_bp.route('/function/<function_id>/edit', methods=['GET', 'POST'])
def edit_function(function_id):
    """编辑功能"""
    pass
4.2.2 中间件设计
python
# middleware/dynamic_menu.py - 动态菜单中间件
@app.context_processor
def inject_dynamic_menu():
    """向所有模板注入动态菜单数据"""
    if has_app_context():
        menu_data = get_dynamic_menu(current_user)
        return {'dynamic_menu': menu_data}
    return {}
4.3 前端组件设计
4.3.1 可复用组件
功能卡片组件：用于仪表盘显示功能入口

菜单生成器组件：动态生成导航菜单

富文本编辑器组件：功能内容编辑

权限选择器组件：设置功能访问权限

4.3.2 响应式设计
移动端：汉堡菜单，简化导航

平板端：适度简化，保持易用性

桌面端：完整功能，最佳体验

📋 第五部分：实施计划
5.1 开发阶段安排
阶段一：基础框架搭建（2天）
数据库设计和初始化

动态功能数据模型

基础服务层开发

阶段二：管理界面开发（3天）
功能管理后台

内容编辑器集成

权限配置界面

阶段三：前端集成（2天）
动态菜单生成

路由系统改造

模板渲染引擎

阶段四：测试优化（2天）
功能测试

性能测试

用户体验优化

5.2 优先级划分
高优先级（核心功能）
动态功能数据库设计 ✅

功能管理后台（CRUD）✅

动态菜单生成 ✅

权限控制系统 ✅

中优先级（增强功能）
富文本编辑器集成

多种页面模板支持

菜单拖拽排序

功能导入/导出

低优先级（优化功能）
访问统计和分析

功能使用日志

批量操作工具

高级搜索功能

5.3 风险控制
技术风险
性能风险：动态菜单可能影响页面加载速度

缓解：实现缓存机制，减少数据库查询

安全风险：动态内容可能引入XSS攻击

缓解：严格的内容过滤和转义

兼容性风险：不同浏览器渲染差异

缓解：充分测试，使用渐进增强策略

业务风险
用户接受度：管理员可能不熟悉配置界面

缓解：提供详细文档和培训视频

功能冲突：动态功能与现有功能URL冲突

缓解：URL命名规范，冲突检测机制

🎯 第六部分：成功标准
6.1 技术标准
✅ 动态功能添加时间 < 3分钟

✅ 页面加载时间增加 < 20%

✅ 系统可用性 ≥ 99.5%

✅ 零安全漏洞

6.2 业务标准
✅ 管理员满意度 ≥ 4/5

✅ 用户功能发现率 ≥ 85%

✅ 新功能上线周期缩短 80%

6.3 质量标准
✅ 代码覆盖率 ≥ 80%

✅ 文档完整率 100%

✅ 用户培训材料齐全

📞 附录
A.1 现有功能清单（保持）
用户注册/登录/退出

邮箱验证系统

个人中心（资料编辑、密码修改）

管理员后台（用户管理、清理工具）

自动清理过期用户

A.2 新增功能清单
动态功能配置系统

可配置导航菜单（一级/二级）

多种页面模板支持

灵活的权限控制系统

主界面优化和仪表盘

功能管理后台

A.3 技术栈确认
后端: Flask + MongoDB

前端: Bootstrap 5 + Jinja2

编辑器: CKEditor 5 / SimpleMDE

图标库: Font Awesome 6

部署: 保持现有部署方式

📋 实施确认清单
第一阶段准备
确认数据库设计

准备开发环境

备份现有系统

制定详细开发计划

开发过程
保持现有功能正常运行

分模块开发，逐步集成

每日进度同步

及时测试和反馈

上线准备
完整功能测试

性能压力测试

安全漏洞扫描

用户培训材料

备份和回滚方案

文档状态：✅ 需求明确 - 准备实施

这个文档涵盖了您需要的所有功能，包括：

✅ 已实现的登录注册个人中心等

🔄 新增的动态导航功能系统

🏠 主界面和用户体验优化

📊 完整的实施计划

接下来我们可以开始具体的设计和开发工作！

